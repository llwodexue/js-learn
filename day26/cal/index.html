<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>计算器</title>
        <link rel="stylesheet" href="index.css" />
    </head>
    <body>
        <div id="main">
            <ul class="shop">
                <li>
                    <button class="add" flag="1"></button>
                    <b class="num">0</b>
                    <button class="sub" flag="0"></button>
                    <span class="info">
                        单价:<b class="iprice">1</b>元 小计：
                        <b class="isum">0</b>元
                    </span>
                </li>
                <li>
                    <button class="add" flag="1"></button>
                    <b class="num">0</b>
                    <button class="sub" flag="0"></button>
                    <span class="info">
                        单价:<b class="iprice">2</b>元 小计：
                        <b class="isum">0</b>元
                    </span>
                </li>
                <li>
                    <button class="add" flag="1"></button>
                    <b class="num">0</b>
                    <button class="sub" flag="0"></button>
                    <span class="info">
                        单价:<b class="iprice">3</b>元 小计：
                        <b class="isum">0</b>元
                    </span>
                </li>
            </ul>
            <div class="shopInfo">
                <p>商品共<span class="totalNum">0</span>件</p>
                <p>共花了<span class="totalMoney">0</span>元</p>
                <p>其中最贵的商品单价是<span class="specialPrice">0</span>元</p>
            </div>
        </div>
    </body>
</html>
<!-- <script src="buy.js"></script> -->
<script src="jquery-1.11.3.js"></script>
<script>
    $("button").click(function () {
        let flag = $(this).attr("flag");
        let parent = $(this).parent();
        let num = +parent.find(".num").text();
        let iPrice = +parent.find(".iprice").text();
        if (flag == 1) {
            num = num + 1;
        } else {
            if (num > 0) {
                num = num - 1;
            }
        }
        parent.find(".num").text(num);
        parent.find(".isum").text(num * iPrice);
        let totalNum = 0,
            totalMoney = 0,
            specialPrice = 0;
        $("ul li").each(function (index, item) {
            let tSum = +$(item).find(".num").text();
            totalNum += tSum;
            totalMoney += +$(item).find(".isum").text();
            if (tSum > 0) {
                let Max = +$(item).find(".iprice").text();
                if (Max >= specialPrice) {
                    specialPrice = Max;
                }
            }
        });
        $(".totalNum").text(totalNum);
        $(".totalMoney").text(totalMoney);
        $(".specialPrice").text(specialPrice);
    });
</script>
