[toc]

# 21\_笔记

## 正则组成

`RegExp`（Regular Expression）：JS的一个内置类

- **检验**某个字符串是否符合这个规则
- **捕获**符合某个规则的字符串

### 元字符

- 量词元字符
- 特殊元字符
- 普通元字符

| 量词元字符 | 含义        |
| ---------- | ----------- |
| *          | 0到多次     |
| +          | 1到多次     |
| ?          | 0到1次      |
| {m}        | 出现m次     |
| {n,}       | 至少出现n次 |
| {n,m}      | 出现n到m次  |



| 特殊元字符  | 含义                                                         |
| ----------- | ------------------------------------------------------------ |
| \           | 转义字符：把特殊元字符转换成普通元字符<br>把普通元字符转换为特殊元字符 |
| .           | 任意字符（除了换行符）                                       |
| ^           | 以,,,开头                                                    |
| $           | 以...结尾                                                    |
| \n          | 换行符                                                       |
| \d          | 匹配一个数字，等价于`[0-9]`                                  |
| \D          | 匹配一个非数字，等价于`[^0-9]`                               |
| \w          | 匹配一个单字字符，等价于`[a-zA-Z0-9]`                        |
| \W          | 匹配一个单字字符，等价于`[^a-zA-Z0-9]`                       |
| \s          | 匹配一个空白字符（空格、制表符、换页符）                     |
| \S          | 匹配一个非空白字符                                           |
| \t          | 制表符                                                       |
| \b          | 单词边界                                                     |
| x\|y        | x和y之间的任意一个                                           |
| [a-z]       | a到z之间的任意一个字符                                       |
| [a-zA-Z0-9] | a到z或A到Z或0-9                                              |
| [^a-z]      | 除了a到z之外的任意一个字符                                   |
| ()          | 分组                                                         |
| (?:)        | 只匹配，不捕获                                               |
| (?=)        | 正向预查 `A(?=B)` A后面必须是B                               |
| (?!)        | 负向预查 `A(?!B)` A后面不能是B                               |

```js
// 字符串中认为 \ 不是普通字符
str = '\d' // "d"
// 以23开头 以23结尾（只能是23）
/^23$/.test("2323") // false
// 以2开头 以3结尾，中间是任意字符（除换行符）
/^2.3$/.test("2e3") // true
```

**`()`分组**

1. 提高匹配优先级

   直接写 x|y 会存在优先级问题，为了避免问题，一般写的时候需要伴随小括号进行分组

   ```js
   /^18|29$/.test('189')  // true
   /^18|29$/.test('129')  // true
   /^18|29$/.test('1829') // true
   
   // 这时reg匹配的是以18开始或29结束
   /^(18|29)$/.test('189')  // false
   /^(18|29)$/.test('129')  // false
   /^(18|29)$/.test('1829') // false
   ```

2. 分组引用

   `([a-z])\1` ：让第一个分组的内容出现一次，1 代表第一个分组

   ```js
   var str = "abbc";
   var reg = /^[a-z]([a-z])\1[a-z]$/;
   console.log(reg.test(str)); // true
   
   var str = "abab";
   var reg = /^([a-z]{2})\1$/;
   var reg = /^([a-z](a-z))\1\2$/;
   console.log(reg.test(str)); // true
   
   var str = "acca";
   var reg = /^([a-z]([a-z])\2\1]$)/;
   console.log(reg.test(str)); // true
   ```

3. 分组捕获

   有几个小括号就会分组捕获几次

**`[]`字符合集**

- []中不允许出现多位数

```js
var reg = /^[1-23]$/; // 1-2或3出现1次
// 匹配月份 01-12 [01-09][10-12]
var reg = /^(0[1-9])|(1[0-2])$/
```

### 修饰符

| 修饰符 | 含义         |
| ------ | ------------ |
| i      | 不区分大小写 |
| m      | 多行匹配     |
| g      | 全局匹配     |

## 正则案例

### 验证是否为有效数字

1. 第一位可能是 + - `[+-]?`
2. 个位数（0-9）/多位数（第一位1-9，第二位及以后0-9） `(\d)|([1-9]\d+)`
3. 是否有小数 `(\.\d+)?`

```js
/^[+-]?(0|([1-9]\d+))(\.\d+)?$/
```

### 匹配中文名

1. 汉字：`[\u4E00-\u9FA5]`
2. 长度 2-10 位 `{2,10}`
3. 可以是译名，中间有·，默认最多出现两次 `{0,2}`

```js
/^[\u4E00-\u9FA5]{2,10}(·[\u4E00-\u9FA5]{2,10}){0,2}$/
```

### 匹配身份证

1. 身份证共 18 位

2. 省市区：1-6位  `\d{6}`

3. 年月日：7-14位

   年：1xxx-2xxx `[1-2]\d{3}`

   月：01-09 10-12 `(0[1-9]|1[0-2])`

   日：01-09 10-29 30-31 `(0[1-9]|[1-2]\d|3[0-1])`

4. 15-18位

   1. 前两位是公安局代码 `\d{2}`
   2. 点三位性别，奇数是男，偶数是女 `\d`
   3. 最后一位是数字或X `(\d|X)`

`?:` ：只匹配不捕获

```js
var str = "130000202010101010";
var reg = /(?:\d{6})([1-2]\d{3})(0[1-9]|1[0-2])(0[1-9]|[1-2]\d|3[0-1])\d{2}(\d)(?:X|\d)/;
var res = reg.exec(str);
console.log(`生日：${res[1]}年${res[2]}月${res[3]}日`);
console.log(`性别：${res[4]==0?"女生":"男生"}`);
```

## 正则创建方式

- 字面量 `var reg = /\d+/`

- 构造函数 `var reg = new RegExp("\\d+")`

  构造函数里参数是字符串，需要注意转义字符

字面量方式不能插入变量，因为 // 中间都是元字符，所以正则中要使用变量只能用构造函数

```js
var name = "lion";
var reg = new RegExp(`^${name}`);
console.log(reg.test("lions")); // true
```

## undefined 和 null

### undefined

- 变量提升阶段，只声明未定义，返回 undefined
- 函数但没设置返回值（return），返回 undefined
- 函数有形参但没传实参，返回 undefined
- 获取对象不存在的属性，返回 undefined
- typeof 一个不存在的变量，返回 undefined
- 数组 find 方法中，没有找到返回 undefined
- JS 严格模式，没有指明主题，this 是 undefined

### null

- 手动设置变量的值或某一个属性值为 null
- JS 获取 DOM 元素，如果没有获取到指定的元素对象，返回 null
- 正则捕获时，如果没有捕获到，返回 null
- `Object.prototype.__proto__` 的值是 null
- body 的父级参照物是（offsetParent） null

## 参考

[正则表达式](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions)

[JS中出现undefined与null几种常见情况](https://blog.csdn.net/cherrylee_1210/article/details/78419747)